<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Track Progress</title>
    <link rel="shortcut icon" href="" type="image/x-icon">
    <!-- Bootstrap CSS Link -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <!-- Link to Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css"
        integrity="sha512-Kc323vGBEqzTmouAECnVceyQqyqdsSiqLQISBL29aUW4U/M7pSPA/gEUZQqv1cwx4OnYxTxve5UMg5GT6L4JJg=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <!-- Link to Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=EB+Garamond:ital,wght@0,400..800;1,400..800&display=swap" rel="stylesheet">
    <!-- CSS Link -->
    <link rel="stylesheet" href="assets/css/style.css">
</head>

<body>

    <!-- Track Progress Start -->
    <section class="kyp-bg track-progress-bg">
        <!-- KYP Head -->
        <div class="kyp-head">
            <div class="logo">
                <img src="assets/images/logo/logo.webp" alt="logo" loading="lazy">
            </div>
        </div>
        <!-- Track Progress Head -->
        <div class="track-progress-head">
            <h1>Track Your Monthly Cashback Progress</h1>
            <p>Spend more to unlock your next cashback tier. Every bill counts!</p>
        </div> 
        <!-- Spend Tracker -->
        <div class="spend-tracker">
            <!-- Tier Labels -->
            <div class="tiers-header">
                <div class="tier-label" data-min="3300" data-max="4000">
                    <h3>Tier 1</h3>
                    <p><span>Unlock</span> Flat ₹100</p>
                </div>
                <div class="tier-label" data-min="4001" data-max="5000">
                    <h3>Tier 2</h3>
                    <p><span>Unlock</span> Upto ₹200</p>
                </div>
                <div class="tier-label" data-min="5001" data-max="10000">
                    <h3>Tier 3</h3>
                    <p><span>Unlock</span> Upto ₹600</p>
                </div>
            </div>
            <!-- Progress Bar -->
            <div class="tracker-bar">
                <div class="tier-box" id="tier1"><span>₹3300 - ₹4000</span></div>
                <div class="tier-box" id="tier2"><span>₹4001 - ₹5000</span></div>
                <div class="tier-box" id="tier3"><span>₹5001 - ₹10000 & above</span></div>
                <div class="spend-indicator" id="spend-indicator">₹0</div>
            </div>
        </div> 
        <div class="tracker-foot">
            <p>Last Updated: <span>24 June, 11:59 PM</span></p>
        </div>
        <!-- Track Progress Sub Head-->
        <div class="track-progress-sub-head">
            <h4>You've Spent <span>₹4,750</span> this month.</h4>
            <h5>Spend <span>₹250</span> more to unlock <span>₹600</span> cashback for June.</h5>
        </div>
        <!-- Track Progress Card-->
        <div class="track-progress-card">
            <p>Know your Eligible Spend</p>
            <div class="progress-bar">
                <div class="bar-left">
                    <p><i class="fa-solid fa-store"></i> Spencers Store</p>
                </div>
                <div class="bar-right" style="--progress: 70%;">
                    <span>₹1,520</span>
                </div>
            </div>
            <div class="progress-bar">
                <div class="bar-left">
                    <p><i class="fa-solid fa-tablet-screen-button"></i> Jiffy App</p>
                </div>
                <div class="bar-right" style="--progress: 30%;">
                    <span>₹1,130</span>
                </div>
            </div>
            <p class="text-center mt-3 mt-sm-4">Keep shopping & earning!</p>
            <div class="btn-row">
                <a href=""><button>Shop In-Store</button></a>
                <a href=""><button>Order via Jiffy</button></a>
            </div>
        </div>
        <!-- Footer -->
        <footer>
            <a href="">Home</a>
            <a href="">Transaction Details</a>
            <a href="">Wallet Passbook</a>
            <a href="">FAQ</a>
            <a href="">T&C</a>
            <a href="">Contact Us</a>
        </footer> 
    </section>
    <!-- Track Progress End -->


    <!-- -------------------------------------------------------------------------------------------------------------------------------- -->

    <!-- Bootstrap JS Link -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
        crossorigin="anonymous"></script>

    <script>
        const currentSpend = 4700; // Replace with the actual current spend fetched using Backend

        const tiers = [
            { id: 'tier1', min: 3300, max: 4000 },
            { id: 'tier2', min: 4001, max: 5000 },
            { id: 'tier3', min: 5001, max: 10000 }
        ];

        let indicatorPlaced = false;

        tiers.forEach(tier => {
            const el = document.getElementById(tier.id);
            const textSpan = el.querySelector('span');
            let progress = 0;
            let fillColor = 'transparent';
            let textColor = '#c19c63';

            const isInThisTier = currentSpend >= tier.min && currentSpend <= tier.max;

            if (currentSpend >= tier.max) {
                progress = 100;
                fillColor = 'linear-gradient(to right, #eac677, #9d6f2b)';
                textColor = '#000';
            } else if (currentSpend >= tier.min) {
                progress = ((currentSpend - tier.min) / (tier.max - tier.min)) * 100;
                fillColor = 'white';
                textColor = '#c19c63';
            }

            el.style.setProperty('--progress', `${progress}%`);
            el.style.setProperty('--fill-color', fillColor);
            textSpan.style.color = textColor;

            if (!indicatorPlaced && isInThisTier) {
                const indicator = document.getElementById("spend-indicator");
                const wrapper = document.createElement("div");
                wrapper.style.position = "absolute";
                wrapper.style.left = `${progress}%`;
                wrapper.style.transform = "translateX(-50%)";
                wrapper.appendChild(indicator);
                el.appendChild(wrapper);
                indicator.textContent = `₹${currentSpend}`;
                indicatorPlaced = true;
            }
        });

        // If spend is above all tiers
        if (!indicatorPlaced && currentSpend > 10000) {
            const tier3 = document.getElementById("tier3");
            const indicator = document.getElementById("spend-indicator");
            const wrapper = document.createElement("div");
            wrapper.style.position = "absolute";
            wrapper.style.right = "0";
            wrapper.style.transform = "translateX(50%)";
            wrapper.appendChild(indicator);
            tier3.appendChild(wrapper);
            indicator.textContent = `₹${currentSpend}`;
        }

        // Update tier label spans to "Unlocked" if tier is completed
        document.querySelectorAll(".tier-label").forEach(label => {
            const min = parseInt(label.getAttribute("data-min"), 10);
            const max = parseInt(label.getAttribute("data-max"), 10);
            const span = label.querySelector("span");

            if (currentSpend >= max && span) {
                span.textContent = "Unlocked";
            }
        });
    </script>

    <!-- JS Link -->
    <script src="assets/js/script.js"></script>

</body>

</html>